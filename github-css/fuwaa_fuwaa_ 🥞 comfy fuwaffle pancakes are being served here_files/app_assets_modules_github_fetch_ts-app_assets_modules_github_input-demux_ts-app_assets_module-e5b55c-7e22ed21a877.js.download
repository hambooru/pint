"use strict";(()=>{var T=Object.defineProperty;var p=(g,_)=>T(g,"name",{value:_,configurable:!0});(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_assets_modules_github_fetch_ts-app_assets_modules_github_input-demux_ts-app_assets_module-e5b55c"],{29719:(g,_,u)=>{u.d(_,{D:()=>l,a:()=>d});var f=u(17463),c=u(12981);async function d(r,i,n){const h=new Request(i,n);h.headers.append("X-Requested-With","XMLHttpRequest");const t=await self.fetch(h);if(t.status<200||t.status>=300)throw new Error(`HTTP ${t.status}${t.statusText||""}`);return(0,f.t)((0,f.P)(r),t),(0,c.r)(r,await t.text())}p(d,"fetchSafeDocumentFragment");function l(r,i,n=1e3){return p(async function h(t){const e=new Request(r,i);e.headers.append("X-Requested-With","XMLHttpRequest");const s=await self.fetch(e);if(s.status<200||s.status>=300)throw new Error(`HTTP ${s.status}${s.statusText||""}`);if(s.status===200)return s;if(s.status===202)return await new Promise(o=>setTimeout(o,t)),h(t*1.5);throw new Error(`Unexpected ${s.status} response status from poll endpoint`)},"poll")(n)}p(l,"fetchPoll")},17463:(g,_,u)=>{u.d(_,{P:()=>f,t:()=>d});function f(l){const r=[...l.querySelectorAll("meta[name=html-safe-nonce]")].map(i=>i.content);if(r.length<1)throw new Error("could not find html-safe-nonce on document");return r}p(f,"getDocumentHtmlSafeNonces");class c extends Error{constructor(r,i){super(`${r} for HTTP ${i.status}`);this.response=i}}p(c,"ResponseError");function d(l,r,i=!1){const n=r.headers.get("content-type")||"";if(!i&&!n.startsWith("text/html"))throw new c(`expected response with text/html, but was ${n}`,r);if(i&&!(n.startsWith("text/html")||n.startsWith("application/json")))throw new c(`expected response with text/html or application/json, but was ${n}`,r);const h=r.headers.get("x-html-safe");if(h){if(!l.includes(h))throw new c("response X-HTML-Safe nonce did not match",r)}else throw new c("missing X-HTML-Safe nonce",r)}p(d,"verifyResponseHtmlSafeNonce")},49662:(g,_,u)=>{var f=u(35803),c=Object.defineProperty,d=Object.getOwnPropertyDescriptor,l=p((i,n,h,t)=>{for(var e=t>1?void 0:t?d(n,h):n,s=i.length-1,o;s>=0;s--)(o=i[s])&&(e=(t?o(n,h,e):o(e))||e);return t&&e&&c(n,h,e),e},"__decorateClass");let r=p(class extends HTMLElement{connectedCallback(){this.control&&(this.storedInput=Array(this.control.children.length).fill("")),this.addEventListener("input",this.relayInput.bind(this)),this.addEventListener("keydown",this.relayKeydown.bind(this));const i=this.closest("details");i&&i.addEventListener("toggle",()=>{i.open&&this.source.focus()})}relayKeydown(i){if((this.isControlTab(i.target)||i.target===this.source)&&(i.key==="ArrowDown"||i.key==="Tab"))i.preventDefault(),i.stopPropagation(),this.routeCustomEvent(new CustomEvent("focus-list"));else if(i.key==="Escape"){const n=this.closest("details");n&&n.removeAttribute("open")}}isControlTab(i){return!i||!this.control?!1:Array.from(this.control.children).includes(i)}relayInput(i){if(!i.target)return;const h=i.target.value;this.routeCustomEvent(new CustomEvent("input-entered",{detail:h}))}routeCustomEvent(i){this.sinks[this.selectedIndex].dispatchEvent(i)}get selectedIndex(){if(!this.control)return 0;const i=this.control.querySelector('[aria-selected="true"]');return i?Array.from(this.control.children).indexOf(i):0}storeInput(){this.storedInput[this.selectedIndex]=this.source.value}updateInput(i){this.source.value=this.storedInput[this.selectedIndex];const n=i.detail.relatedTarget.getAttribute("data-filter-placeholder");this.source.placeholder=n,this.source.setAttribute("aria-label",n),this.notifySelected()}notifySelected(){const i=this.sinks[this.selectedIndex],n=new CustomEvent("tab-selected");i.dispatchEvent(n)}},"InputDemuxElement");l([f.fA],r.prototype,"source",2),l([f.GO],r.prototype,"sinks",2),l([f.fA],r.prototype,"control",2),r=l([f.Ih],r)},19832:(g,_,u)=>{var f=u(69121),c=u(69567),d=u(35803),l=u(17945),r=Object.defineProperty,i=Object.getOwnPropertyDescriptor,n=p((t,e,s,o)=>{for(var a=o>1?void 0:o?i(e,s):e,w=t.length-1,m;w>=0;w--)(m=t[w])&&(a=(o?m(e,s,a):m(a))||a);return o&&a&&r(e,s,a),a},"__decorateClass");let h=p(class extends HTMLElement{constructor(){super(...arguments);this.isCurrentVisible=!1,this.currentSelectionIndex=null,this.handleWindowResize=()=>{if(!this.virtualizedList)return;const t=this.isMobileViewport,e=this.windowHeight;this.updateViewportSize();const s=t!==this.isMobileViewport,o=e!==this.windowHeight;if(s){this.virtualizedList.destroy(),this.setupVirtualizedList();return}!this.isMobileViewport||!o||(this.listContainer.style.maxHeight=`${this.listHeight}px`,this.virtualizedList.resize(this.listHeight))},this.windowResized=()=>{this.resizeAnimationRequest&&cancelAnimationFrame(this.resizeAnimationRequest),this.resizeAnimationRequest=requestAnimationFrame(this.handleWindowResize)}}connectedCallback(){window.addEventListener("resize",this.windowResized),this.refType=this.getRequiredAttr("type")==="branch"?f.r.Branch:f.r.Tag;const t=this.getAttribute("current-committish");this.currentCommittish=t?atob(t):null,this.input=this.hasAttribute("initial-filter")&&this.currentCommittish||"",this.defaultBranch=atob(this.getRequiredAttr("default-branch")),this.nameWithOwner=atob(this.getRequiredAttr("name-with-owner")),this.canCreate=this.hasAttribute("can-create"),this.prefetchOnMouseover=this.hasAttribute("prefetch-on-mouseover");const e=this.getRequiredAttr("query-endpoint"),s=this.getRequiredAttr("cache-key");this.index=new f.W(this.refType,this,e,s,this.nameWithOwner),this.updateViewportSize(),this.setupFetchListeners()}disconnectedCallback(){this.resizeAnimationRequest&&cancelAnimationFrame(this.resizeAnimationRequest),window.removeEventListener("resize",this.windowResized)}updateViewportSize(){this.isMobileViewport=window.innerWidth<544,this.windowHeight=window.innerHeight}inputEntered(t){this.input=t.detail,this.render()}tabSelected(){this.index.fetchData()}renderTemplate(t,e){return new c.R(t,e,c.XK)}renderRow(t){const e=this.index.currentSearchResult[t];if(!e&&t>=this.listLength)return document.createElement("span");if(this.index.fetchFailed)return this.renderTemplate(this.fetchFailedTemplate,{index:t,refName:this.input});if(!e){const m=this.input===this.currentCommittish;return this.isCurrentVisible||(this.isCurrentVisible=m),this.renderTemplate(this.noMatchTemplate,{index:t,isCurrent:m,refName:this.input})}const s=this.input.length>0,o=s?"is-filtering":"",a=e===this.currentCommittish;this.isCurrentVisible||(this.isCurrentVisible=a);const w=this.renderTemplate(this.itemTemplate,{refName:e,index:t,isFilteringClass:o,urlEncodedRefName:this.urlEncodeRef(e),isCurrent:a,isNotDefault:e!==this.defaultBranch});if(s){const m=w.querySelector("span");m.textContent="";const C=e.split(this.input),y=C.length-1;for(let E=0;E<C.length;E++){const L=C[E];if(m.appendChild(document.createTextNode(L)),E<y){const b=document.createElement("b");b.textContent=this.input,m.appendChild(b)}}}return w}urlEncodeRef(t){return encodeURIComponent(t).replaceAll("%2F","/").replaceAll("%3A",":").replaceAll("%2B","+")}render(){if(this.currentSelectionIndex=null,!this.index.isLoading){if(!this.virtualizedList){this.index.search(this.input),this.setupVirtualizedList();return}this.listContainer.scrollTop=0,this.index.search(this.input),this.virtualizedList.setRowCount(this.listLength)}}get listHeight(){return this.isMobileViewport?this.windowHeight*.3:330}get listLength(){const t=this.index.currentSearchResult.length;return this.showCreateRow?t+1:t||1}get showCreateRow(){return!this.index.fetchFailed&&!this.index.exactMatchFound&&this.input!==""&&this.canCreate}getRequiredAttr(t,e=this){const s=e.getAttribute(t);if(!s)throw new Error(`Missing attribute for ${e}: ${t}`);return s}setupFetchListeners(){const t=this.closest("details");let e=!1;const s=p(()=>{e||(this.index.fetchData(),e=!0)},"fetch");if(!t||t.open){s();return}this.prefetchOnMouseover&&t.addEventListener("mouseover",s,{once:!0}),this.addEventListener("keydown",this.keydown),this.addEventListener("change",this.updateCurrent);const o=t.querySelector("input[data-ref-filter]");o&&(o.addEventListener("input",()=>{this.input=o.value,this.render()}),o.addEventListener("keydown",a=>{if(a.key==="ArrowDown"||a.key==="Tab")a.preventDefault(),a.stopPropagation(),this.focusFirstListMember();else if(a.key==="Enter"){let w=this.index.currentSearchResult.indexOf(this.input);if(w===-1)if(this.showCreateRow)w=this.listLength-1;else return;t.querySelector(`[data-index="${w}"]`).click(),a.preventDefault()}}))}focusFirstListMember(){!this.virtualizedList||(this.currentSelectionIndex=0,this.focusItemAtIndex(this.currentSelectionIndex))}updateCurrent(t){t.target instanceof HTMLInputElement&&t.target.checked&&t.target.value&&(this.currentCommittish=t.target.value)}keydown(t){if(this.currentSelectionIndex!==null){if(t.key==="Enter"){const e=document.activeElement;if(!e)return;e.click(),t.preventDefault();return}if(!(t.key==="Tab"&&t.shiftKey)&&t.key!=="Escape")switch(t.preventDefault(),t.stopPropagation(),t.key){case"ArrowUp":{this.currentSelectionIndex--,this.currentSelectionIndex<0&&(this.currentSelectionIndex=this.listLength-1),this.focusItemAtIndex(this.currentSelectionIndex);break}case"Home":{this.currentSelectionIndex=0,this.focusItemAtIndex(this.currentSelectionIndex);break}case"End":{this.currentSelectionIndex=this.listLength-1,this.focusItemAtIndex(this.currentSelectionIndex);break}case"Tab":case"ArrowDown":{this.currentSelectionIndex++,this.currentSelectionIndex>this.listLength-1&&(this.currentSelectionIndex=0),this.focusItemAtIndex(this.currentSelectionIndex);break}}}}focusItemAtIndex(t){this.virtualizedList.scrollToIndex(t,"center"),setTimeout(()=>{const e=this.listContainer.querySelector(`[data-index="${t}"]`);e&&e.focus()},20)}setupVirtualizedList(){this.listContainer.innerHTML="",this.listContainer.style.maxHeight=`${this.listHeight}px`,this.virtualizedList=new l.Z(this.listContainer,{height:this.listHeight,rowCount:this.listLength,renderRow:this.renderRow.bind(this),rowHeight:t=>{const e=this.isMobileViewport?54:33;return this.showCreateRow&&t===this.listLength-1?51:e},onRowsRendered:()=>{this.hiddenCurrentElement&&(this.listContainer.removeChild(this.hiddenCurrentElement),delete this.hiddenCurrentElement),this.isCurrentVisible?this.isCurrentVisible=!1:this.hiddenCurrentItemTemplate&&(this.hiddenCurrentElement=document.createElement("div"),this.hiddenCurrentElement?.appendChild(this.renderTemplate(this.hiddenCurrentItemTemplate,{refName:this.currentCommittish})),this.listContainer.appendChild(this.hiddenCurrentElement))},initialIndex:0,overscanCount:6}),this.virtualizedList.resize.bind(this.virtualizedList)}},"RefSelectorElement");n([d.fA],h.prototype,"listContainer",2),n([d.fA],h.prototype,"itemTemplate",2),n([d.fA],h.prototype,"noMatchTemplate",2),n([d.fA],h.prototype,"fetchFailedTemplate",2),n([d.fA],h.prototype,"hiddenCurrentItemTemplate",2),h=n([d.Ih],h)},69121:(g,_,u)=>{u.d(_,{W:()=>h,r:()=>i});var f=u(84818),c=u(45922);const{getItem:d,setItem:l,removeItem:r}=(0,f.Z)("localStorage",{throwQuotaErrorsOnSet:!0});var i=(t=>(t.Branch="branch",t.Tag="tag",t))(i||{});const n=p(class{constructor(t,e,s,o,a){this.knownItems=[],this.currentSearchResult=[],this.exactMatchFound=!1,this.searchTerm="",this.isLoading=!0,this.fetchInProgress=!1,this.fetchFailed=!1,this.refType=t,this.selector=e,this.refEndpoint=s,this.cacheKey=o,this.nameWithOwner=a}render(){this.selector.render()}async fetchData(){try{if(!this.isLoading||this.fetchInProgress)return;if(!this.bootstrapFromLocalStorage()){this.fetchInProgress=!0,this.fetchFailed=!1;const t=await fetch(`${this.refEndpoint}?type=${this.refType}`,{headers:{Accept:"application/json"}});await this.processResponse(t)}this.isLoading=!1,this.fetchInProgress=!1,this.render()}catch{this.fetchInProgress=!1,this.fetchFailed=!0}}async processResponse(t){if(this.emitStats(t),!t.ok){this.fetchFailed=!0;return}const e=t.clone(),s=await t.json();this.knownItems=s.refs,this.cacheKey=s.cacheKey,this.flushToLocalStorage(await e.text())}emitStats(t){if(!t.ok){(0,c.b)({incrementKey:"REF_SELECTOR_BOOT_FAILED"},!0);return}switch(t.status){case 200:{(0,c.b)({incrementKey:"REF_SELECTOR_BOOTED_FROM_UNCACHED_HTTP"});break}case 304:{(0,c.b)({incrementKey:"REF_SELECTOR_BOOTED_FROM_HTTP_CACHE"});break}default:(0,c.b)({incrementKey:"REF_SELECTOR_UNEXPECTED_RESPONSE"})}}search(t){if(this.searchTerm=t,t===""){this.currentSearchResult=this.knownItems;return}const e=[],s=[];this.exactMatchFound=!1;let o;for(const a of this.knownItems)if(o=a.indexOf(t),!(o<0)){if(o===0){t===a?(s.unshift(a),this.exactMatchFound=!0):s.push(a);continue}e.push(a)}this.currentSearchResult=[...s,...e]}bootstrapFromLocalStorage(){const t=d(this.localStorageKey);if(!t)return!1;const e=JSON.parse(t);return e.cacheKey!==this.cacheKey||!("refs"in e)?(r(this.localStorageKey),!1):(this.knownItems=e.refs,this.isLoading=!1,(0,c.b)({incrementKey:"REF_SELECTOR_BOOTED_FROM_LOCALSTORAGE"}),!0)}async flushToLocalStorage(t){try{l(this.localStorageKey,t)}catch(e){if(e.message.toLowerCase().includes("quota")){this.clearSiblingLocalStorage(),(0,c.b)({incrementKey:"REF_SELECTOR_LOCALSTORAGE_OVERFLOWED"});try{l(this.localStorageKey,t)}catch(s){s.message.toLowerCase().includes("quota")&&(0,c.b)({incrementKey:"REF_SELECTOR_LOCALSTORAGE_GAVE_UP"})}}else throw e}}clearSiblingLocalStorage(){for(const t of Object.keys(localStorage))t.startsWith(n.LocalStoragePrefix)&&r(t)}get localStorageKey(){return`${n.LocalStoragePrefix}:${this.nameWithOwner}:${this.refType}`}},"_SearchIndex");let h=n;h.LocalStoragePrefix="ref-selector"},44780:(g,_,u)=>{var f=u(64463);const c=p(()=>{const d=document.getElementById("spoof-warning");if(!d)return;const l=document.querySelector(".commit-title");l&&l.classList.add("pb-1"),d.hidden=!1,d.removeAttribute("aria-hidden")},"showSpoofCommitBanner");(0,f.N7)("#js-spoofed-commit-warning-trigger",{add:c})}}]);})();

//# sourceMappingURL=app_assets_modules_github_fetch_ts-app_assets_modules_github_input-demux_ts-app_assets_module-e5b55c-5e46185dd8e0.js.map